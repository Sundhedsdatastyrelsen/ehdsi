package dk.sundhedsdatastyrelsen.ncpeh.service.mapping; import dk.sundhedsdatastyrelsen.ncpeh.cda.Oid; import dk.sundhedsdatastyrelsen.ncpeh.service.exception.DataRequirementException; import java.util.regex.Pattern; public final class PatientIdMapper { private static final String regexPattern = "(\\d{10})(?:\\^{3}&" + Oid.DK_CPR.value + "&ISO)?"; private static final Pattern patientIdPattern = Pattern.compile(regexPattern); private PatientIdMapper() { } public static String toCpr(String patientId) { if (patientId == null) { return null; } var matcher = patientIdPattern.matcher(patientId); if (!matcher.matches()) { throw new DataRequirementException("'" + patientId + "' doesn't match any of the expected patterns"); } return matcher.group(1); } } 